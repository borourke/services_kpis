<div id="report_cards" data-reports="<%= @report_cards_charts.to_json %>"></div>


<script>
$(function () {
  var report_cards = $("#report_cards").data('reports')
  console.log(report_cards)
    $('#my_report_cards').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Monthly Average Rainfall'
        },
        subtitle: {
            text: 'Source: WorldClimate.com'
        },
        xAxis: {
            categories: ['Job Medals', 'Project Medals', 
              'Technical Medals', 'Efficiency Medals']
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Rainfall (mm)'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            name: 'Gold',
            data: report_cards["gold"]

        }, {
            name: 'Silver',
            data: report_cards["silver"]

        }, {
            name: 'Bronze',
            data: report_cards["bronze"]

        }, {
            name: 'None',
            data: report_cards["none"]

        }, {
            name: 'N/A',
            data: report_cards["na"]

        }]
    });
});

</script>

<div class="row-fluid">
<div class="well center span10 offset1 top">
  <h1><%= gravatar_for @user %> My Report Cards | <%= @user.name %></h1>
</div>
</div>

<div class="row-fluid">
  <div class="span10 offset1 well">
    <h3 class="center">Overall Report Card Table</h3>
    <table id="report_cards_overall" class="display">
      <thead>
        <tr>
          <th>Project name</th>
          <th>Job Score</th>
          <th>Technical Score</th>
          <th>Project Score</th>
          <th>Efficiency Score</th>
          <th>Total Points</th>
          <th>Comments</th>
        </tr>
      </thead>
      <tbody>
        <% @report_cards_array[:tables].each do |report_card| %>
        <tr>
          <td><%= report_card["project_name"] %></td>
          <td><%= report_card["job_score"] %></td>
          <td><%= report_card["technical_score"] %></td>
          <td><%= report_card["project_score"] %></td>
          <td><%= report_card["efficiency_score"] %></td>
          <td class="center"><%= report_card["points"] %></td>
          <td><%= report_card["comments"] %></td>
        </tr>
        <% end %>
      </tbody>
    </table> 
 </div>
</div>

<div class="row-fluid">
  <div class="span10 offset1 well">
    <h3 class="center">Detailed Report Card Table</h3>
    <table id="report_cards_detailed" class="display">
      <thead>
        <tr>
          <th>Project name</th>
          <th>Job Points</th>
          <th>Technical Points</th>
          <th>Project Points</th>
          <th>Efficiency Points</th>
          <th>Total Points</th>
          <th>Comments</th>
        </tr>
      </thead>
      <tbody>
        <% @report_cards_array[:tables].each do |report_card| %>
        <tr>
          <td><%= report_card["project_name"] %></td>
          <td><%= report_card["job_array"] %></td>
          <td><%= report_card["technical_array"] %></td>
          <td><%= report_card["project_array"] %></td>
          <td><%= report_card["efficiency_score"] %></td>
          <td class="center"><%= report_card["points"] %></td>
          <td><%= report_card["comments"] %></td>
        </tr>
        <% end %>
      </tbody>
    </table> 
 </div>
</div>

<p><%= @report_cards_charts %></p>

<div class="row-fluid">
  <div class="well span10 offset1">
    <div id="my_report_cards" style="width:100%; height:400px;"></div>
  </div>
</div>
