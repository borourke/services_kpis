<div id="channing-is-fucking-awesome" data-medals="<%= @medals_count_all_time.to_json %>"></div>
<div id="month_medals_hash" data-medals="<%= @medals_month_hash.to_json %>"></div>

<script>
$(function () {

    var gaugeOptions = {

       chart: {
          type: 'solidgauge'
      },

      title: null,

      pane: {
          center: ['50%', '85%'],
          size: '140%',
          startAngle: -90,
          endAngle: 90,
          background: {
             backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
             innerRadius: '60%',
             outerRadius: '100%',
             shape: 'arc'
         }
     },

     tooltip: {
      enabled: false
  },

    // the value axis
    yAxis: {
    	stops: [
            [0.25, '#DF5353'], // red
            [0.50, '#DDDF0D'], // yellow
            [0.75, '#55BF3B'] // green
            ],
            lineWidth: 0,
            minorTickInterval: null,
            tickPixelInterval: 400,
            tickWidth: 0,
            title: {
            	y: -160
            },
            labels: {
            	y: 16
            }
        },

        plotOptions: {
         solidgauge: {
            dataLabels: {
               y: 5,
               borderWidth: 0,
               useHTML: true
           }
       }
   }
};

// The speed gauge
$('#happiness_gauge').highcharts(Highcharts.merge(gaugeOptions, {
	yAxis: {
		min: 0,
		max: 100,
		title: {
			text: '<span style="font-size:18px;color:black">Average Happiness This Month</span>'
		}
	},

	credits: {
		enabled: false
	},

	series: [{
		name: 'Speed',
		data: [<%= @this_months_happiness_average %>],
		dataLabels: {
			format: '<div style="text-align:center"><span style="font-size:25px;color:' +
			((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span><br/>' +
			'<span style="font-size:18px;color:black">Services Happiness</span></div>'
		},
		tooltip: {
			valueSuffix: 'Smiles :)'
}
}]

}));

});

$(function () {
    var medals_hash = $("#channing-is-fucking-awesome").data('medals');
    console.log(medals_hash)

// Medal Counts
$('#all_time_medals_chart').highcharts({
	chart: {
		type: 'column'
	},
	title: {
		text: 'Services All Time Medal Count'
	},
	xAxis: {
		type: 'category',
		categories: [
		'Gold', 
		'Silver', 
		'Bronze', 
		'None', 
		'N/A'
		]
	},
	yAxis: {
		min: 0,
		title: {
			text: 'Medal Count'
		}
	},
	tooltip: {
		headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		pointFormat: '<tr><td padding:0">{series.name}: </td>' +
		'<td style="padding:0"><b>{point.y}</b></td></tr>',
		footerFormat: '</table>',
		shared: true,
		useHTML: true
	},
	plotOptions: {
		column: {
			pointPadding: 0.2,
			borderWidth: 0
		}
	},
	series: [{
		name: 'Medals',
		data: [{y: medals_hash['Gold'], color: '#FFCC00'}, {y: medals_hash['Silver'], color: 'silver'}, {y: medals_hash['Bronze'], color: '#CC6633'}, {y: medals_hash['None'], color: 'red'}, {y: medals_hash['N/A'], color: 'black'}],
		color: 'white',
		dataLabels: {
			enabled: true,
			format: '{point.y}'
		}
	}],
	legend: {
		enabled: false
	},
});

});

$(function () {
    var month_medals_hash = $("#month_medals_hash").data('medals');
    console.log(month_medals_hash)
    $('#month_medals_chart').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Medals Count by Month'
        },
        subtitle: {
            text: 'Last 12 Months'
        },
        xAxis: {
            categories: month_medals_hash["months"]
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Medals Count'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y}</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            name: 'Gold',
            data: month_medals_hash["medals_count"]["Gold"],    
            color: '#FFCC00'

        }, {
            name: 'Silver',
            data: month_medals_hash["medals_count"]["Silver"],
            color: 'silver'

        }, {
            name: 'Bronze',
            data: month_medals_hash["medals_count"]["Bronze"],
            color: '#CC6633'

        }, {
            name: 'None',
            data: month_medals_hash["medals_count"]["None"],
            color: 'red'

        }, {
            name: 'N/A',
            data: month_medals_hash["medals_count"]["N/A"],
            color: 'black'

        }]
    });
});
</script>
<div class="row-fluid">
    <div class="well center span10 offset1 top">
       <h1>Welcome Home, <%= current_user.name %>!</h1> 
   </div>
</div>
<% if current_user.admin? %>
<div class="row-fluid">
    <div class="well span5 offset1"> 
       <div id="happiness_gauge" style="width:100%; height:400px;"></div>
   </div>

   <div class="well span5"> 
       <div id="all_time_medals_chart" style="width:100%; height:400px;"></div>
   </div>
</div>

<div class="row-fluid">
    <div class="well span10 offset1 bottom"> 
        <div id="month_medals_chart" style="width:100%; height:400px;"></div>
    </div>
</div>

<% elsif !(current_user.admin?) %>

<% end %>